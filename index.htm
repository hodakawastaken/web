<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Personal Website</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght=100..900&display=swap" rel="stylesheet">
    <style>
        /* Apply Inter font and smooth transitions globally */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; /* Slate-900 for dark mode feel */
            color: #f8fafc; /* Slate-50 */
        }
        .page-content {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
        .page-content.active {
            display: block;
            opacity: 1;
        }
        .nav-link {
            transition: all 0.2s ease;
        }
        .nav-link:hover {
            transform: translateY(-2px);
            opacity: 0.9;
        }
        /* Custom styles for the song cover animation */
        #song-cover-wrapper {
            transition: all 0.3s ease-in-out;
        }
        .cover-slide-out {
            opacity: 0;
            transform: scale(0.9);
        }
        .cover-slide-in {
            opacity: 1;
            transform: scale(1);
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">

    <div class="max-w-4xl mx-auto bg-slate-800 p-6 sm:p-10 rounded-xl shadow-2xl">

        <header class="mb-8">
            <h1 class="text-3xl md:text-4xl font-extrabold text-indigo-400 mb-4">Tech Genius Hub</h1>
            <nav class="flex space-x-2 md:space-x-4 border-b border-indigo-500 pb-2">
                <button onclick="showPage('home')" id="nav-home" class="nav-link px-3 py-1 md:px-4 md:py-2 rounded-lg bg-indigo-600 text-white font-medium hover:bg-indigo-500">
                    Home
                </button>
                <button onclick="showPage('socials')" id="nav-socials" class="nav-link px-3 py-1 md:px-4 md:py-2 rounded-lg bg-slate-700 text-slate-300 font-medium hover:bg-slate-600">
                    Socials
                </button>
                <button onclick="showPage('music')" id="nav-music" class="nav-link px-3 py-1 md:px-4 md:py-2 rounded-lg bg-slate-700 text-slate-300 font-medium hover:bg-slate-600">
                    Music Player
                </button>
            </nav>
        </header>

        <section id="home" class="page-content active">
            <h2 class="text-2xl font-bold mb-4">Welcome to My Corner of the Web!</h2>
            
            <div id="discord-profile" class="hidden p-4 bg-slate-700 rounded-lg mb-4 flex items-center space-x-4 border border-indigo-500">
                <img id="discord-avatar" class="w-16 h-16 rounded-full" src="" alt="Avatar">
                <div>
                    <p id="discord-username" class="text-xl font-bold text-indigo-300">Loading...</p>
                    <p id="discord-id" class="text-sm text-slate-300">Loading ID...</p>
                </div>
            </div>

            <button onclick="loginWithDiscord()" id="discord-login-btn" class="bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded-lg font-semibold transition duration-200">
                Connect Discord Profile
            </button>

            <p class="mt-6 text-slate-300">
                This section displays my live Discord profile once you connect it! As a tech genius and gamer, Discord is where I hang out.
            </p>
            <p class="text-sm text-slate-500 italic mt-2">
                Note: You must replace the **REDIRECT_URI** variable in the script below for the Discord connection to work.
            </p>
        </section>

        <section id="socials" class="page-content">
            <h2 class="text-2xl font-bold mb-6">Connect with Me Online</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

                <a href="#" class="block p-5 bg-slate-700 rounded-xl shadow-lg hover:bg-slate-600 transition duration-300 transform hover:-translate-y-1">
                    <h3 class="text-xl font-semibold text-green-400 mb-2 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
                        </svg>
                        Code Repositories
                    </h3>
                    <p class="text-sm text-slate-400">See the projects I'm building and experimenting with. (Mock Link)</p>
                </a>

                <a href="#" class="block p-5 bg-slate-700 rounded-xl shadow-lg hover:bg-slate-600 transition duration-300 transform hover:-translate-y-1">
                    <h3 class="text-xl font-semibold text-red-400 mb-2 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.75a2 2 0 01-1.841-1.285L6.5 14.75M14 10V5a2 2 0 00-2-2h-1a2 2 0 00-2 2v2M8 20.75V14.75" />
                        </svg>
                        Gaming Feed
                    </h3>
                    <p class="text-sm text-slate-400">My latest gaming adventures and adaptable strategies. (Mock Link)</p>
                </a>

                <a href="#" class="block p-5 bg-slate-700 rounded-xl shadow-lg hover:bg-slate-600 transition duration-300 transform hover:-translate-y-1">
                    <h3 class="text-xl font-semibold text-yellow-400 mb-2 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                        Digital Art / Thoughts
                    </h3>
                    <p class="text-sm text-slate-400">A space for my digital art experiments. (Mock Link)</p>
                </a>

                <a href="mailto:contact@example.com" class="block p-5 bg-slate-700 rounded-xl shadow-lg hover:bg-slate-600 transition duration-300 transform hover:-translate-y-1">
                    <h3 class="text-xl font-semibold text-blue-400 mb-2 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8m-2 4v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
                        </svg>
                        Email Me
                    </h3>
                    <p class="text-sm text-slate-400">Get in touch for collaborations or questions. (Mock Link)</p>
                </a>

            </div>
        </section>

        <section id="music" class="page-content">
            <h2 class="text-2xl font-bold mb-6">Music Player: My Current Jams</h2>

            <div class="flex flex-col items-center space-y-6">

                <div id="song-cover-wrapper" class="w-48 h-48 md:w-64 md:h-64 rounded-xl shadow-lg overflow-hidden relative cover-slide-in">
                    <img id="song-cover" src="" alt="Album Cover">
                    <div class="absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center">
                        <p id="song-info" class="text-lg font-bold text-white text-center p-2"></p>
                    </div>
                </div>

                <audio id="audio-player" src="" preload="auto"></audio>

                <div class="w-full max-w-sm flex justify-center space-x-4">
                    <button id="play-pause-btn" class="bg-indigo-600 text-white p-3 rounded-full shadow-md hover:bg-indigo-500 transition duration-200 focus:outline-none focus:ring-4 focus:ring-indigo-500 focus:ring-opacity-50" title="Play / Pause">
                        <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197 2.132A1 1 0 0110 13.205v-4.41a1 1 0 011.555-.832l3.197 2.132a1 1 0 010 1.664z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </button>

                    <button id="next-song-btn" onclick="nextSong()" class="bg-slate-700 text-white p-3 rounded-full shadow-md hover:bg-slate-600 transition duration-200 focus:outline-none focus:ring-4 focus:ring-slate-500 focus:ring-opacity-50" title="Next Song">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7" />
                        </svg>
                    </button>
                </div>

                <div class="w-full max-w-md flex items-center space-x-3 mt-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.586-4.586A1 1 0 0112 5v14a1 1 0 01-1.879.514L5.586 15z" />
                    </svg>
                    <input type="range" id="volume-slider" min="0" max="100" value="70" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer focus:outline-none" style="--tw-ring-color: #4f46e5;">
                    <span id="volume-text" class="text-sm w-8 text-center text-slate-400">70%</span>
                </div>

                <div id="message-box" class="mt-4 p-3 bg-indigo-900 border border-indigo-500 rounded-lg text-sm hidden w-full max-w-md text-center">
                    Song loaded. Press play!
                </div>

            </div>
        </section>

    </div>

    <script>
        // --- Single-Page Navigation Logic ---

        const navButtons = {
            home: document.getElementById('nav-home'),
            socials: document.getElementById('nav-socials'),
            music: document.getElementById('nav-music'),
        };

        const pageSections = {
            home: document.getElementById('home'),
            socials: document.getElementById('socials'),
            music: document.getElementById('music'),
        };

        /**
         * Switches the active page content and updates the navigation button styles.
         * @param {string} pageId - The ID of the page to show ('home', 'socials', 'music').
         */
        function showPage(pageId) {
            // Reset styles for all navigation buttons
            Object.values(navButtons).forEach(btn => {
                btn.classList.remove('bg-indigo-600', 'text-white', 'hover:bg-indigo-500');
                btn.classList.add('bg-slate-700', 'text-slate-300', 'hover:bg-slate-600');
            });

            // Set active style for the current button
            navButtons[pageId].classList.remove('bg-slate-700', 'text-slate-300', 'hover:bg-slate-600');
            navButtons[pageId].classList.add('bg-indigo-600', 'text-white', 'hover:bg-indigo-500');

            // Hide all pages and show the active one with a transition
            Object.keys(pageSections).forEach(id => {
                pageSections[id].classList.remove('active');
            });
            // Use a short timeout to allow the transition to apply
            setTimeout(() => {
                pageSections[pageId].classList.add('active');
            }, 10);
        }
        
        // --- Discord OAuth2 Logic ---

        const CLIENT_ID = "1440082318365692090"; // <<< Discord Application Client ID (Updated)
        const REDIRECT_URI = "YOUR_WEBSITE_URL_HERE"; // <<< IMPORTANT: Replace with the URL of this page
        const SCOPE = "identify";

        function loginWithDiscord() {
            if (REDIRECT_URI === "YOUR_WEBSITE_URL_HERE") {
                console.error("REDIRECT_URI is not set. Please update the script with the URL of this page.");
                alertBox("Discord connection failed: Please set the REDIRECT_URI in the script!", true);
                return;
            }
            const url = `https://discord.com/oauth2/authorize?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=token&scope=${SCOPE}`;
            window.location.href = url;
        }

        function checkDiscordToken() {
            const hash = window.location.hash;
            if (hash.includes("access_token")) {
                const params = new URLSearchParams(hash.substring(1));
                const token = params.get("access_token");

                // Clear the hash from the URL for a cleaner look
                history.replaceState(null, null, ' '); 

                fetch("https://discord.com/api/users/@me", {
                    headers: { Authorization: `Bearer ${token}` }
                })
                .then(res => {
                    if (!res.ok) throw new Error('Failed to fetch Discord user data');
                    return res.json();
                })
                .then(user => {
                    document.getElementById('discord-login-btn').classList.add('hidden');

                    // Discord avatar construction (handling both new and old formats)
                    let avatarUrl;
                    if (user.avatar) {
                        const avatarFormat = user.avatar.startsWith('a_') ? 'gif' : 'png';
                        avatarUrl = `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.${avatarFormat}`;
                    } else {
                        // Default avatar URL calculation
                        const defaultAvatarIndex = user.discriminator === '0' 
                            ? (BigInt(user.id) >> 22n) % 6n 
                            : user.discriminator % 5;
                        avatarUrl = `https://cdn.discordapp.com/embed/avatars/${defaultAvatarIndex}.png`;
                    }

                    document.getElementById('discord-avatar').src = avatarUrl;

                    // Handle new username format (discriminator '0' or old format)
                    const usernameDisplay = user.discriminator === '0' 
                        ? user.global_name || user.username
                        : `${user.username}#${user.discriminator}`;

                    document.getElementById('discord-username').textContent = usernameDisplay;
                    document.getElementById('discord-id').textContent = `ID: ${user.id}`;
                    document.getElementById('discord-profile').classList.remove('hidden');
                    alertBox(`Welcome, ${usernameDisplay}! Your profile is connected.`, false);
                })
                .catch(err => {
                    console.error("Error fetching Discord profile:", err);
                    document.getElementById('discord-login-btn').textContent = "Connection Failed. Try again?";
                    alertBox("Could not fetch profile. Check the console for errors.", true);
                });
            }
        }

        // --- Music Player Logic ---

        const audioPlayer = document.getElementById('audio-player');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const volumeSlider = document.getElementById('volume-slider');
        const volumeText = document.getElementById('volume-text');
        const songCover = document.getElementById('song-cover');
        const songCoverWrapper = document.getElementById('song-cover-wrapper');
        const songInfo = document.getElementById('song-info');
        const messageBox = document.getElementById('message-box');

        const playlist = [
            {
                title: "Neon Drive",
                artist: "Synthwave Guru",
                source: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3", // Mock MP3 URL
                cover: "https://placehold.co/256x256/4f46e5/ffffff?text=Neon+Drive" // Indigo
            },
            {
                title: "Digital Oasis",
                artist: "Code Composer",
                source: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3", // Mock MP3 URL
                cover: "https://placehold.co/256x256/0d9488/ffffff?text=Digital+Oasis" // Teal
            },
            {
                title: "Bitstream Bliss",
                artist: "8-Bit Hero",
                source: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3", // Mock MP3 URL
                cover: "https://placehold.co/256x256/dc2626/ffffff?text=Bitstream+Bliss" // Red
            }
        ];

        let currentSongIndex = 0;
        let isPlaying = false;

        /**
         * Updates the UI and loads the song into the audio player.
         * @param {number} index - The index of the song in the playlist array.
         * @param {boolean} shouldPlay - If true, starts playback immediately.
         */
        function loadSong(index, shouldPlay = false) {
            const song = playlist[index];
            if (!song) return; // Guard

            // 1. Start the slide animation (slide out)
            songCoverWrapper.classList.remove('cover-slide-in');
            songCoverWrapper.classList.add('cover-slide-out');
            
            // Wait for the slide-out animation to finish before updating content
            setTimeout(() => {
                // 2. Update content
                audioPlayer.src = song.source;
                songCover.src = song.cover;
                songInfo.textContent = `${song.title} by ${song.artist}`;
                
                // 3. Slide the new cover in
                songCoverWrapper.classList.remove('cover-slide-out');
                songCoverWrapper.classList.add('cover-slide-in');
                
                audioPlayer.load();

                if (shouldPlay) {
                    audioPlayer.play().catch(error => {
                        console.error("Autoplay failed:", error);
                        showMessage("Autoplay failed. Press play button to start.", "error");
                        isPlaying = false;
                        updatePlayPauseIcon();
                    });
                    isPlaying = true;
                }
                updatePlayPauseIcon();
                showMessage(`Now playing: ${song.title}`, "success");

            }, 300); // Match this delay to the CSS transition time (0.3s)
        }

        /**
         * Toggles between play and pause states.
         */
        function togglePlayPause() {
            if (isPlaying) {
                audioPlayer.pause();
                showMessage("Music paused.");
            } else {
                audioPlayer.play().catch(error => {
                    console.error("Error playing audio:", error);
                    showMessage("Could not play music. Check console for details.", "error");
                });
                showMessage("Music playing.");
            }
            isPlaying = !isPlaying;
            updatePlayPauseIcon();
        }

        /**
         * Switches to the next song in the playlist.
         */
        function nextSong() {
            currentSongIndex = (currentSongIndex + 1) % playlist.length;
            loadSong(currentSongIndex, true); // Play the next song immediately
        }

        /**
         * Updates the Play/Pause button icon based on the state.
         */
        function updatePlayPauseIcon() {
            if (isPlaying) {
                playIcon.classList.add('hidden');
                pauseIcon.classList.remove('hidden');
            } else {
                playIcon.classList.remove('hidden');
                pauseIcon.classList.add('hidden');
            }
        }

        /**
         * Handles the volume slider change.
         */
        function handleVolumeChange() {
            const volume = volumeSlider.value / 100;
            audioPlayer.volume = volume;
            volumeText.textContent = `${volumeSlider.value}%`;
            showMessage(`Volume set to ${volumeSlider.value}%`);
        }

        /**
         * Displays a temporary message in the feedback box.
         * @param {string} message - The message to display.
         */
        function showMessage(message) {
            messageBox.textContent = message;
            messageBox.classList.remove('hidden');
            clearTimeout(messageBox.timeout);
            messageBox.timeout = setTimeout(() => {
                messageBox.classList.add('hidden');
            }, 3000);
        }

        /** Custom function to handle messages instead of alert() */
        function alertBox(message, isError) {
            showMessage(message);
            if (isError) {
                messageBox.classList.add('bg-red-900', 'border-red-500');
                messageBox.classList.remove('bg-indigo-900', 'border-indigo-500');
            } else {
                messageBox.classList.add('bg-indigo-900', 'border-indigo-500');
                messageBox.classList.remove('bg-red-900', 'border-red-500');
            }
        }

        // --- Global Initialization ---

        window.onload = function() {
            // Check for Discord token on load
            checkDiscordToken();

            // --- Music Player Init ---
            // Set initial volume
            audioPlayer.volume = volumeSlider.value / 100;

            // Load the first song
            loadSong(currentSongIndex, false);

            // Connect controls to functions
            playPauseBtn.addEventListener('click', togglePlayPause);
            volumeSlider.addEventListener('input', handleVolumeChange);
            
            // Auto advance to next song when current song ends
            audioPlayer.addEventListener('ended', nextSong);
        };

    </script>

</body>
</html>